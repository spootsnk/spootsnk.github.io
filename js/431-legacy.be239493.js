"use strict";(self["webpackChunkgeoguess"]=self["webpackChunkgeoguess"]||[]).push([[431],{9705:function(e,t,r){var i=r(31540);function n(e){var t=[1/0,1/0,-1/0,-1/0];return i.coordEach(e,(function(e){t[0]>e[0]&&(t[0]=e[0]),t[1]>e[1]&&(t[1]=e[1]),t[2]<e[0]&&(t[2]=e[0]),t[3]<e[1]&&(t[3]=e[1])})),t}n["default"]=n,t.Z=n},88147:function(e,t,r){var i=r(10611);function n(e,t,r){if(void 0===r&&(r={}),!e)throw new Error("point is required");if(!t)throw new Error("polygon is required");var n=i.getCoord(e),s=i.getGeom(t),l=s.type,u=t.bbox,c=s.coordinates;if(u&&!1===o(n,u))return!1;"Polygon"===l&&(c=[c]);for(var d=!1,m=0;m<c.length&&!d;m++)if(a(n,c[m][0],r.ignoreBoundary)){var h=!1,p=1;while(p<c[m].length&&!h)a(n,c[m][p],!r.ignoreBoundary)&&(h=!0),p++;h||(d=!0)}return d}function a(e,t,r){var i=!1;t[0][0]===t[t.length-1][0]&&t[0][1]===t[t.length-1][1]&&(t=t.slice(0,t.length-1));for(var n=0,a=t.length-1;n<t.length;a=n++){var o=t[n][0],s=t[n][1],l=t[a][0],u=t[a][1],c=e[1]*(o-l)+s*(l-e[0])+u*(e[0]-o)===0&&(o-e[0])*(l-e[0])<=0&&(s-e[1])*(u-e[1])<=0;if(c)return!r;var d=s>e[1]!==u>e[1]&&e[0]<(l-o)*(e[1]-s)/(u-s)+o;d&&(i=!i)}return i}function o(e,t){return t[0]<=e[0]&&t[1]<=e[1]&&t[2]>=e[0]&&t[3]>=e[1]}t.Z=n},84102:function(e,t){function r(e,t,r){void 0===r&&(r={});var i={type:"Feature"};return(0===r.id||r.id)&&(i.id=r.id),r.bbox&&(i.bbox=r.bbox),i.properties=t||{},i.geometry=e,i}function i(e,t,r){switch(void 0===r&&(r={}),e){case"Point":return n(t).geometry;case"LineString":return l(t).geometry;case"Polygon":return o(t).geometry;case"MultiPoint":return m(t).geometry;case"MultiLineString":return d(t).geometry;case"MultiPolygon":return h(t).geometry;default:throw new Error(e+" is invalid")}}function n(e,t,i){if(void 0===i&&(i={}),!e)throw new Error("coordinates is required");if(!Array.isArray(e))throw new Error("coordinates must be an Array");if(e.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!P(e[0])||!P(e[1]))throw new Error("coordinates must contain numbers");var n={type:"Point",coordinates:e};return r(n,t,i)}function a(e,t,r){return void 0===r&&(r={}),c(e.map((function(e){return n(e,t)})),r)}function o(e,t,i){void 0===i&&(i={});for(var n=0,a=e;n<a.length;n++){var o=a[n];if(o.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var s=0;s<o[o.length-1].length;s++)if(o[o.length-1][s]!==o[0][s])throw new Error("First and last Position are not equivalent.")}var l={type:"Polygon",coordinates:e};return r(l,t,i)}function s(e,t,r){return void 0===r&&(r={}),c(e.map((function(e){return o(e,t)})),r)}function l(e,t,i){if(void 0===i&&(i={}),e.length<2)throw new Error("coordinates must be an array of two or more positions");var n={type:"LineString",coordinates:e};return r(n,t,i)}function u(e,t,r){return void 0===r&&(r={}),c(e.map((function(e){return l(e,t)})),r)}function c(e,t){void 0===t&&(t={});var r={type:"FeatureCollection"};return t.id&&(r.id=t.id),t.bbox&&(r.bbox=t.bbox),r.features=e,r}function d(e,t,i){void 0===i&&(i={});var n={type:"MultiLineString",coordinates:e};return r(n,t,i)}function m(e,t,i){void 0===i&&(i={});var n={type:"MultiPoint",coordinates:e};return r(n,t,i)}function h(e,t,i){void 0===i&&(i={});var n={type:"MultiPolygon",coordinates:e};return r(n,t,i)}function p(e,t,i){void 0===i&&(i={});var n={type:"GeometryCollection",geometries:e};return r(n,t,i)}function f(e,t){if(void 0===t&&(t=0),t&&!(t>=0))throw new Error("precision must be a positive number");var r=Math.pow(10,t||0);return Math.round(e*r)/r}function g(e,r){void 0===r&&(r="kilometers");var i=t.factors[r];if(!i)throw new Error(r+" units is invalid");return e*i}function y(e,r){void 0===r&&(r="kilometers");var i=t.factors[r];if(!i)throw new Error(r+" units is invalid");return e/i}function v(e,t){return b(y(e,t))}function w(e){var t=e%360;return t<0&&(t+=360),t}function b(e){var t=e%(2*Math.PI);return 180*t/Math.PI}function S(e){var t=e%360;return t*Math.PI/180}function x(e,t,r){if(void 0===t&&(t="kilometers"),void 0===r&&(r="kilometers"),!(e>=0))throw new Error("length must be a positive number");return g(y(e,t),r)}function k(e,r,i){if(void 0===r&&(r="meters"),void 0===i&&(i="kilometers"),!(e>=0))throw new Error("area must be a positive number");var n=t.areaFactors[r];if(!n)throw new Error("invalid original units");var a=t.areaFactors[i];if(!a)throw new Error("invalid final units");return e/n*a}function P(e){return!isNaN(e)&&null!==e&&!Array.isArray(e)}function C(e){return!!e&&e.constructor===Object}function M(e){if(!e)throw new Error("bbox is required");if(!Array.isArray(e))throw new Error("bbox must be an Array");if(4!==e.length&&6!==e.length)throw new Error("bbox must be an Array of 4 or 6 numbers");e.forEach((function(e){if(!P(e))throw new Error("bbox must only contain numbers")}))}function _(e){if(!e)throw new Error("id is required");if(-1===["string","number"].indexOf(typeof e))throw new Error("id must be a number or a string")}Object.defineProperty(t,"__esModule",{value:!0}),t.earthRadius=6371008.8,t.factors={centimeters:100*t.earthRadius,centimetres:100*t.earthRadius,degrees:t.earthRadius/111325,feet:3.28084*t.earthRadius,inches:39.37*t.earthRadius,kilometers:t.earthRadius/1e3,kilometres:t.earthRadius/1e3,meters:t.earthRadius,metres:t.earthRadius,miles:t.earthRadius/1609.344,millimeters:1e3*t.earthRadius,millimetres:1e3*t.earthRadius,nauticalmiles:t.earthRadius/1852,radians:1,yards:1.0936*t.earthRadius},t.unitsFactors={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:.001,kilometres:.001,meters:1,metres:1,miles:1/1609.344,millimeters:1e3,millimetres:1e3,nauticalmiles:1/1852,radians:1/t.earthRadius,yards:1.0936133},t.areaFactors={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,hectares:1e-4,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,millimeters:1e6,millimetres:1e6,yards:1.195990046},t.feature=r,t.geometry=i,t.point=n,t.points=a,t.polygon=o,t.polygons=s,t.lineString=l,t.lineStrings=u,t.featureCollection=c,t.multiLineString=d,t.multiPoint=m,t.multiPolygon=h,t.geometryCollection=p,t.round=f,t.radiansToLength=g,t.lengthToRadians=y,t.lengthToDegrees=v,t.bearingToAzimuth=w,t.radiansToDegrees=b,t.degreesToRadians=S,t.convertLength=x,t.convertArea=k,t.isNumber=P,t.isObject=C,t.validateBBox=M,t.validateId=_},10611:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var i=r(84102);function n(e){if(!e)throw new Error("coord is required");if(!Array.isArray(e)){if("Feature"===e.type&&null!==e.geometry&&"Point"===e.geometry.type)return e.geometry.coordinates;if("Point"===e.type)return e.coordinates}if(Array.isArray(e)&&e.length>=2&&!Array.isArray(e[0])&&!Array.isArray(e[1]))return e;throw new Error("coord must be GeoJSON Point or an Array of numbers")}function a(e){if(Array.isArray(e))return e;if("Feature"===e.type){if(null!==e.geometry)return e.geometry.coordinates}else if(e.coordinates)return e.coordinates;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")}function o(e){if(e.length>1&&i.isNumber(e[0])&&i.isNumber(e[1]))return!0;if(Array.isArray(e[0])&&e[0].length)return o(e[0]);throw new Error("coordinates must only contain numbers")}function s(e,t,r){if(!t||!r)throw new Error("type and name required");if(!e||e.type!==t)throw new Error("Invalid input to "+r+": must be a "+t+", given "+e.type)}function l(e,t,r){if(!e)throw new Error("No feature passed");if(!r)throw new Error(".featureOf() requires a name");if(!e||"Feature"!==e.type||!e.geometry)throw new Error("Invalid input to "+r+", Feature with geometry required");if(!e.geometry||e.geometry.type!==t)throw new Error("Invalid input to "+r+": must be a "+t+", given "+e.geometry.type)}function u(e,t,r){if(!e)throw new Error("No featureCollection passed");if(!r)throw new Error(".collectionOf() requires a name");if(!e||"FeatureCollection"!==e.type)throw new Error("Invalid input to "+r+", FeatureCollection required");for(var i=0,n=e.features;i<n.length;i++){var a=n[i];if(!a||"Feature"!==a.type||!a.geometry)throw new Error("Invalid input to "+r+", Feature with geometry required");if(!a.geometry||a.geometry.type!==t)throw new Error("Invalid input to "+r+": must be a "+t+", given "+a.geometry.type)}}function c(e){return"Feature"===e.type?e.geometry:e}function d(e,t){return"FeatureCollection"===e.type?"FeatureCollection":"GeometryCollection"===e.type?"GeometryCollection":"Feature"===e.type&&null!==e.geometry?e.geometry.type:e.type}t.getCoord=n,t.getCoords=a,t.containsNumber=o,t.geojsonType=s,t.featureOf=l,t.collectionOf=u,t.getGeom=c,t.getType=d},31540:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var i=r(84102);function n(e,t,r){if(null!==e)for(var i,a,o,s,l,u,c,d,m=0,h=0,p=e.type,f="FeatureCollection"===p,g="Feature"===p,y=f?e.features.length:1,v=0;v<y;v++){c=f?e.features[v].geometry:g?e.geometry:e,d=!!c&&"GeometryCollection"===c.type,l=d?c.geometries.length:1;for(var w=0;w<l;w++){var b=0,S=0;if(s=d?c.geometries[w]:c,null!==s){u=s.coordinates;var x=s.type;switch(m=!r||"Polygon"!==x&&"MultiPolygon"!==x?0:1,x){case null:break;case"Point":if(!1===t(u,h,v,b,S))return!1;h++,b++;break;case"LineString":case"MultiPoint":for(i=0;i<u.length;i++){if(!1===t(u[i],h,v,b,S))return!1;h++,"MultiPoint"===x&&b++}"LineString"===x&&b++;break;case"Polygon":case"MultiLineString":for(i=0;i<u.length;i++){for(a=0;a<u[i].length-m;a++){if(!1===t(u[i][a],h,v,b,S))return!1;h++}"MultiLineString"===x&&b++,"Polygon"===x&&S++}"Polygon"===x&&b++;break;case"MultiPolygon":for(i=0;i<u.length;i++){for(S=0,a=0;a<u[i].length;a++){for(o=0;o<u[i][a].length-m;o++){if(!1===t(u[i][a][o],h,v,b,S))return!1;h++}S++}b++}break;case"GeometryCollection":for(i=0;i<s.geometries.length;i++)if(!1===n(s.geometries[i],t,r))return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function a(e,t,r,i){var a=r;return n(e,(function(e,i,n,o,s){a=0===i&&void 0===r?e:t(a,e,i,n,o,s)}),i),a}function o(e,t){var r;switch(e.type){case"FeatureCollection":for(r=0;r<e.features.length;r++)if(!1===t(e.features[r].properties,r))break;break;case"Feature":t(e.properties,0);break}}function s(e,t,r){var i=r;return o(e,(function(e,n){i=0===n&&void 0===r?e:t(i,e,n)})),i}function l(e,t){if("Feature"===e.type)t(e,0);else if("FeatureCollection"===e.type)for(var r=0;r<e.features.length;r++)if(!1===t(e.features[r],r))break}function u(e,t,r){var i=r;return l(e,(function(e,n){i=0===n&&void 0===r?e:t(i,e,n)})),i}function c(e){var t=[];return n(e,(function(e){t.push(e)})),t}function d(e,t){var r,i,n,a,o,s,l,u,c,d,m=0,h="FeatureCollection"===e.type,p="Feature"===e.type,f=h?e.features.length:1;for(r=0;r<f;r++){for(s=h?e.features[r].geometry:p?e.geometry:e,u=h?e.features[r].properties:p?e.properties:{},c=h?e.features[r].bbox:p?e.bbox:void 0,d=h?e.features[r].id:p?e.id:void 0,l=!!s&&"GeometryCollection"===s.type,o=l?s.geometries.length:1,n=0;n<o;n++)if(a=l?s.geometries[n]:s,null!==a)switch(a.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":if(!1===t(a,m,u,c,d))return!1;break;case"GeometryCollection":for(i=0;i<a.geometries.length;i++)if(!1===t(a.geometries[i],m,u,c,d))return!1;break;default:throw new Error("Unknown Geometry Type")}else if(!1===t(null,m,u,c,d))return!1;m++}}function m(e,t,r){var i=r;return d(e,(function(e,n,a,o,s){i=0===n&&void 0===r?e:t(i,e,n,a,o,s)})),i}function h(e,t){d(e,(function(e,r,n,a,o){var s,l=null===e?null:e.type;switch(l){case null:case"Point":case"LineString":case"Polygon":return!1!==t(i.feature(e,n,{bbox:a,id:o}),r,0)&&void 0}switch(l){case"MultiPoint":s="Point";break;case"MultiLineString":s="LineString";break;case"MultiPolygon":s="Polygon";break}for(var u=0;u<e.coordinates.length;u++){var c=e.coordinates[u],d={type:s,coordinates:c};if(!1===t(i.feature(d,n),r,u))return!1}}))}function p(e,t,r){var i=r;return h(e,(function(e,n,a){i=0===n&&0===a&&void 0===r?e:t(i,e,n,a)})),i}function f(e,t){h(e,(function(e,r,a){var o=0;if(e.geometry){var s=e.geometry.type;if("Point"!==s&&"MultiPoint"!==s){var l,u=0,c=0,d=0;return!1!==n(e,(function(n,s,m,h,p){if(void 0===l||r>u||h>c||p>d)return l=n,u=r,c=h,d=p,void(o=0);var f=i.lineString([l,n],e.properties);if(!1===t(f,r,a,p,o))return!1;o++,l=n}))&&void 0}}}))}function g(e,t,r){var i=r,n=!1;return f(e,(function(e,a,o,s,l){i=!1===n&&void 0===r?e:t(i,e,a,o,s,l),n=!0})),i}function y(e,t){if(!e)throw new Error("geojson is required");h(e,(function(e,r,n){if(null!==e.geometry){var a=e.geometry.type,o=e.geometry.coordinates;switch(a){case"LineString":if(!1===t(e,r,n,0,0))return!1;break;case"Polygon":for(var s=0;s<o.length;s++)if(!1===t(i.lineString(o[s],e.properties),r,n,s))return!1;break}}}))}function v(e,t,r){var i=r;return y(e,(function(e,n,a,o){i=0===n&&void 0===r?e:t(i,e,n,a,o)})),i}function w(e,t){if(t=t||{},!i.isObject(t))throw new Error("options is invalid");var r,n=t.featureIndex||0,a=t.multiFeatureIndex||0,o=t.geometryIndex||0,s=t.segmentIndex||0,l=t.properties;switch(e.type){case"FeatureCollection":n<0&&(n=e.features.length+n),l=l||e.features[n].properties,r=e.features[n].geometry;break;case"Feature":l=l||e.properties,r=e.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":r=e;break;default:throw new Error("geojson is invalid")}if(null===r)return null;var u=r.coordinates;switch(r.type){case"Point":case"MultiPoint":return null;case"LineString":return s<0&&(s=u.length+s-1),i.lineString([u[s],u[s+1]],l,t);case"Polygon":return o<0&&(o=u.length+o),s<0&&(s=u[o].length+s-1),i.lineString([u[o][s],u[o][s+1]],l,t);case"MultiLineString":return a<0&&(a=u.length+a),s<0&&(s=u[a].length+s-1),i.lineString([u[a][s],u[a][s+1]],l,t);case"MultiPolygon":return a<0&&(a=u.length+a),o<0&&(o=u[a].length+o),s<0&&(s=u[a][o].length-s-1),i.lineString([u[a][o][s],u[a][o][s+1]],l,t)}throw new Error("geojson is invalid")}function b(e,t){if(t=t||{},!i.isObject(t))throw new Error("options is invalid");var r,n=t.featureIndex||0,a=t.multiFeatureIndex||0,o=t.geometryIndex||0,s=t.coordIndex||0,l=t.properties;switch(e.type){case"FeatureCollection":n<0&&(n=e.features.length+n),l=l||e.features[n].properties,r=e.features[n].geometry;break;case"Feature":l=l||e.properties,r=e.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":r=e;break;default:throw new Error("geojson is invalid")}if(null===r)return null;var u=r.coordinates;switch(r.type){case"Point":return i.point(u,l,t);case"MultiPoint":return a<0&&(a=u.length+a),i.point(u[a],l,t);case"LineString":return s<0&&(s=u.length+s),i.point(u[s],l,t);case"Polygon":return o<0&&(o=u.length+o),s<0&&(s=u[o].length+s),i.point(u[o][s],l,t);case"MultiLineString":return a<0&&(a=u.length+a),s<0&&(s=u[a].length+s),i.point(u[a][s],l,t);case"MultiPolygon":return a<0&&(a=u.length+a),o<0&&(o=u[a].length+o),s<0&&(s=u[a][o].length-s),i.point(u[a][o][s],l,t)}throw new Error("geojson is invalid")}t.coordAll=c,t.coordEach=n,t.coordReduce=a,t.featureEach=l,t.featureReduce=u,t.findPoint=b,t.findSegment=w,t.flattenEach=h,t.flattenReduce=p,t.geomEach=d,t.geomReduce=m,t.lineEach=y,t.lineReduce=v,t.propEach=o,t.propReduce=s,t.segmentEach=f,t.segmentReduce=g},16295:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var i=r(84102);function n(e){return Array.isArray(e)?m(e):e&&e.bbox?m(e.bbox):[c(),d()]}function a(e,t){void 0===t&&(t={}),void 0!==e&&null!==e||(e=1);for(var r=[],a=0;a<e;a++)r.push(i.point(n(t.bbox)));return i.featureCollection(r)}function o(e,t){void 0===t&&(t={}),void 0!==e&&null!==e||(e=1),i.isNumber(t.num_vertices)&&void 0!==t.num_vertices||(t.num_vertices=10),i.isNumber(t.max_radial_length)&&void 0!==t.max_radial_length||(t.max_radial_length=10);for(var r=[],a=function(e){var a=[],o=Array.apply(null,new Array(t.num_vertices+1)).map(Math.random);o.forEach((function(e,t,r){r[t]=t>0?e+r[t-1]:e})),o.forEach((function(e){e=2*e*Math.PI/o[o.length-1];var r=Math.random();a.push([r*(t.max_radial_length||10)*Math.sin(e),r*(t.max_radial_length||10)*Math.cos(e)])})),a[a.length-1]=a[0],a=a.map(l(n(t.bbox))),r.push(i.polygon([a]))},o=0;o<e;o++)a(o);return i.featureCollection(r)}function s(e,t){if(void 0===t&&(t={}),t=t||{},!i.isObject(t))throw new Error("options is invalid");var r=t.bbox,a=t.num_vertices,o=t.max_length,s=t.max_rotation;void 0!==e&&null!==e||(e=1),(!i.isNumber(a)||void 0===a||a<2)&&(a=10),i.isNumber(o)&&void 0!==o||(o=1e-4),i.isNumber(s)&&void 0!==s||(s=Math.PI/8);for(var l=[],u=0;u<e;u++){for(var c=n(r),d=[c],m=0;m<a-1;m++){var h=0===m?2*Math.random()*Math.PI:Math.tan((d[m][1]-d[m-1][1])/(d[m][0]-d[m-1][0])),p=h+(Math.random()-.5)*s*2,f=Math.random()*o;d.push([d[m][0]+f*Math.cos(p),d[m][1]+f*Math.sin(p)])}l.push(i.lineString(d))}return i.featureCollection(l)}function l(e){return function(t){return[t[0]+e[0],t[1]+e[1]]}}function u(){return Math.random()-.5}function c(){return 360*u()}function d(){return 180*u()}function m(e){return[Math.random()*(e[2]-e[0])+e[0],Math.random()*(e[3]-e[1])+e[1]]}t.randomPosition=n,t.randomPoint=a,t.randomPolygon=o,t.randomLineString=s},83753:function(e,t,r){var i=r(82109),n=r(46916);i({target:"URL",proto:!0,enumerable:!0},{toJSON:function(){return n(URL.prototype.toString,this)}})},53043:function(e,t,r){const i=r(9705).Z,n=r(16295),a=r(88147).Z;function o(e){if(!e||!e.type||"Feature"!==e.type||-1===["Polygon","MultiPolygon"].indexOf(e.geometry.type))throw new Error("param polygon must be a Feature<(Polygon|MultiPolygon)>");let t;const r=i(e);do{t=n.randomPosition(r)}while(!a(t,e));return t}e.exports=o},6431:function(e,t,r){r.r(t),r.d(t,{default:function(){return Ee}});var i=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{attrs:{id:"game-page"}},[r("div",{attrs:{id:"street-view-container"}},[r("HeaderGame",{ref:"header",attrs:{distance:e.scoreHeader,points:e.pointsHeader,round:e.round,"room-name":e.roomName,"nb-round":e.nbRound,"remaining-time":e.remainingTime,mode:e.mode}}),r("div",{attrs:{id:"game-interface"}},[r("v-overlay",{attrs:{value:!e.isReady&&e.multiplayer,opacity:"1"}}),r("div",{ref:"streetView",attrs:{id:"street-view"}}),r("div",{attrs:{id:"game-interface__overlay"}},[r("v-tooltip",{attrs:{top:""},scopedSlots:e._u([{key:"activator",fn:function(t){var i=t.on,n=t.attrs;return[r("v-btn",e._g(e._b({staticClass:"resetBtn",attrs:{rounded:"",dark:"",fab:""},on:{click:e.resetLocation}},"v-btn",n,!1),i),[r("v-icon",[e._v("mdi-crosshairs-gps")])],1)]}}])},[r("span",[e._v(e._s(e.$t("Maps.reset")))])]),r("Maps",{ref:"mapContainer",attrs:{"random-lat-lng":e.randomLatLng,"random-feature-properties":e.randomFeatureProperties,"room-name":e.roomName,"player-number":e.playerNumber,"player-name":e.playerName,"is-ready":e.isReady,round:e.round,score:e.score,points:e.points,difficulty:e.difficultyData,"time-limitation":e.timeLimitation,bbox:e.bbox,mode:e.mode,area:e.area,"time-attack":e.timeAttack,"nb-round":e.nbRound,countdown:e.countdown,"score-mode":e.scoreMode,areasGeoJsonUrl:e.areaParams&&e.areaParams.data.urlArea,pathKey:e.areaParams?e.areaParams.data.pathKey:"iso_a2",mapDetails:e.mapDetails},on:{resetLocation:e.resetLocation,calculateDistance:e.updateScore,showResult:e.showResult,goToNextRound:e.goToNextRound,finishGame:e.finishGame}})],1)],1)],1),r("v-overlay",{attrs:{value:e.overlay,opacity:"0.8","z-index":"1"}}),r("DialogMessage",{attrs:{"dialog-message":e.dialogMessage,"dialog-title":e.dialogTitle,"dialog-text":e.dialogText}}),r("div",{staticClass:"alert-container"},[e.isVisibleDialog?r("v-alert",{staticClass:"warning-alert",attrs:{type:"warning",dismissible:""}},[r("b",[e._v(e._s(e.$t("StreetView.nearby.title")))]),e._v(" : "+e._s(e.$t("StreetView.nearby.message"))+" ")]):e._e(),r("v-alert",{attrs:{id:"warningCountdown",type:"info",dismissible:"",transition:"slide-x-transition",prominent:"",icon:"mdi-clock-fast"},model:{value:e.isVisibleCountdownAlert,callback:function(t){e.isVisibleCountdownAlert=t},expression:"isVisibleCountdownAlert"}},[e._v(" "+e._s(e.$tc("StreetView.countdownAlert",e.remainingTime))+" "),r("v-progress-linear",{attrs:{active:e.isVisibleCountdownAlert,color:"white",absolute:"",bottom:""},model:{value:e.countdownPercentage,callback:function(t){e.countdownPercentage=t},expression:"countdownPercentage"}})],1)],1)],1)},n=[],a=r(28250),o=r(24031),s=r(65128),l=(r(9653),r(26699),r(32023),r(15503)),u=(r(14642),function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("v-app-bar",{staticClass:"header-game",attrs:{color:"grey darken-4"}},[null!=e.remainingTime&&e.remainingTime>0?r("div",[r("span",{attrs:{id:"countdown-text"}},[e._v(e._s(e.countdownText))])]):r("div",[r("span",{attrs:{id:"countdown-text"}},[e._v(e._s(e.timerText))])]),e.roomName&&!e.streamerMode?r("div",{staticClass:"round-score-container room-name"},[r("span",{staticClass:"sub-text"},[e._v(e._s(e.$t("HeaderGame.room"))+" : ")]),r("span",{staticClass:"main-text"},[e._v(" "+e._s(e.roomName)+" ")])]):e._e(),r("div",{staticClass:"flex-grow-1"}),r("div",{staticClass:"round-score-container"},[r("span",{staticClass:"sub-text"},[e._v(e._s(e.$t("HeaderGame.round"))+": ")]),r("span",{staticClass:"main-text",attrs:{id:"roundLabel"}},[e._v(" "+e._s(e.round)+" / "+e._s(e.nbRound)+" ")])]),e.isDistanceVisible?r("div",{staticClass:"round-score-container"},[r("span",{staticClass:"sub-text"},[e._v(e._s(e.$t("HeaderGame.distance"))+": ")]),r("span",{staticClass:"main-text"},[e._v(e._s(e.$t("HeaderGame.kmaway",{value:new Intl.NumberFormat(e.$i18n.locale).format(e.distance/1e3)})))])]):e._e(),r("div",{staticClass:"round-points-container"},[r("span",{staticClass:"sub-text"},[e._v(e._s(e.$t("HeaderGame.score"))+": ")]),r("span",{staticClass:"main-text"},[e._v(e._s(e.points))])])])],1)}),c=[],d=r(76927),m=r(8200),h=r(20629),p={props:["distance","points","round","remainingTime","roomName","nbRound"],data:function(){return{startedAt:null,timerText:"",intervalFunction:null}},watch:{round:function(){this.startTimer()}},computed:(0,s.Z)((0,s.Z)({},(0,h.rn)({streamerMode:function(e){return e.homeStore.streamerMode}})),{},{countdownText:function(){return(0,d.Xw)(this.remainingTime)},isDistanceVisible:function(){return this.mode!==m.wz.COUNTRY}}),methods:{startTimer:function(){var e=this;0==this.remainingTime&&(this.startedAt=new Date,this.intervalFunction=setInterval((function(){e.timerText=(0,d.Xw)(Math.round((Date.now()-e.startedAt)/1e3))}),1e3))},stopTimer:function(){this.intervalFunction&&clearInterval(this.intervalFunction)}}},f=p,g=r(43736),y=r(43453),v=r.n(y),w=r(92881),b=(0,g.Z)(f,u,c,!1,null,"32189a00",null),S=b.exports;v()(b,{VAppBar:w.Z});var x=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",e._g({class:[e.$viewport.width>=450&&(e.activeMap||e.pinActive)||e.isMakeGuessButtonClicked||e.isNextButtonVisible?"container-map--active":"",e.printMapFull?"container-map--full":"","container-map--size-"+e.size],attrs:{id:"container-map"}},e.$viewport.width>=450?{mouseover:function(){e.activeMap=!0},mouseleave:function(){e.activeMap=!1}}:{}),[r("div",{staticClass:"container-map_details"},[e.printMapFull?r("DetailsMap",{attrs:{properties:e.randomFeatureProperties}}):e._e()],1),r("div",{staticClass:"container-map_controls"},[r("div",{staticClass:"container-map_btns"},[r("v-btn",{attrs:{fab:"","x-small":""},on:{click:e.showNotepad}},[r("v-icon",{attrs:{dark:""}},[e._v(" mdi-file-document-edit ")])],1),r("v-btn",{attrs:{id:"btnDown",fab:"","x-small":"",disabled:e.size<2},on:{click:function(t){e.size--}}},[r("v-icon",{attrs:{dark:""}},[e._v(" mdi-arrow-bottom-left ")])],1),r("v-btn",{attrs:{id:"btnUp",fab:"","x-small":"",disabled:e.size>3},on:{click:function(t){e.size++}}},[r("v-icon",{attrs:{dark:""}},[e._v(" mdi-arrow-top-right ")])],1),r("v-btn",{attrs:{id:"btnPin",fab:"","x-small":""},on:{click:function(t){e.pinActive=!e.pinActive}}},[r("v-icon",{attrs:{dark:""}},[e._v(" mdi-pin"+e._s(e.pinActive?"-off":"")+" ")])],1)],1)]),e.$viewport.width<450&&!e.isGuessButtonClicked&&e.isMakeGuessButtonClicked?r("v-btn",{attrs:{id:"hide-map-button",fab:"","x-small":"",color:"red"},on:{click:e.hideMap}},[r("v-icon",{attrs:{color:"white"}},[e._v(" mdi-close ")])],1):e._e(),"classic"===this.mode?r("Map",{ref:"map",attrs:{id:"map",bbox:e.bbox},on:{setSeletedPos:e.setSeletedPos}}):e._e(),"classic"!==this.mode?r("MapAreas",{ref:"map",attrs:{id:"map",area:e.area,areasGeoJsonUrl:e.areasGeoJsonUrl,pathKey:e.pathKey,bbox:e.bbox,showFlag:"country"===this.mode},on:{setSeletedPos:e.setSeletedPos}}):e._e(),e.printMapFull?e._e():r("textarea",{directives:[{name:"show",rawName:"v-show",value:e.isNotepadVisible,expression:"isNotepadVisible"}],ref:"refNotepad",staticClass:"container-map_notepad",attrs:{spellcheck:"false"}}),e._v(" "),e.isNextButtonVisible||e.isSummaryButtonVisible||!(e.$viewport.width>450||e.isMakeGuessButtonClicked)?e._e():r("button",{attrs:{id:"guess-button",disabled:null==e.randomLatLng||null==e.selectedPos||e.isGuessButtonClicked||!!this.room&&!e.isReady},on:{click:e.selectLocation}},[e._v(" "+e._s(e.$t("Maps.guess"))+" ")]),e.isNextButtonVisible?r("button",{style:{backgroundColor:e.isNextButtonEnabled?"#F44336":"#B71C1C"},attrs:{id:"next-button",disabled:!e.isNextButtonEnabled},on:{click:function(t){return e.goToNextRound(!1)}}},[e._v(" "+e._s(e.$t("Maps.nextRound"))+" ")]):e._e(),e.isSummaryButtonVisible?r("button",{attrs:{id:"summary-button"},on:{click:function(t){e.dialogSummary=!0}}},[e._v(" "+e._s(e.$t("Maps.viewSummary"))+" ")]):e._e(),e.$viewport.width<450&&!e.isGuessButtonClicked&&!e.isMakeGuessButtonClicked&&!e.isNextButtonVisible?r("button",{staticClass:"primary",attrs:{id:"make-guess-button"},on:{click:e.showMap}},[e._v(" "+e._s(e.$t("Maps.makeGuess"))+" ")]):e._e(),r("DialogSummary",{attrs:{"dialog-summary":e.dialogSummary,"summary-texts":e.summaryTexts,score:e.score,"player-name":e.playerName,points:e.points,game:e.game,multiplayer:!!e.room,mapDetails:e.mapDetails,"nb-round":e.nbRound},on:{finishGame:e.finishGame,playAgain:function(t){return e.goToNextRound(!0)}}})],1)},k=[],P=(r(41539),r(54747),r(21249),r(83753),r(2707),function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-dialog",{attrs:{value:e.dialogSummary,"max-width":"720",persistent:"",fullscreen:e.$viewport.width<450}},[r("v-card",{attrs:{color:"#061422"}},[r("v-card-text",{attrs:{id:"card-text"}},[e.multiplayer?e._e():r("v-row",{attrs:{justify:"center"}},[r("p",{attrs:{id:"summary-text"},domProps:{innerHTML:e._s(e.$t("DialogSummary.summaryMsgSinglePoints",{points:e.points})+(e.showDistance?e.$t("DialogSummary.summaryMsgSingleDistance",{distance:e.score/1e3}):""))}})]),e._l(e.summaryTexts,(function(t,i){return r("v-row",{key:i,staticClass:"mt-3",attrs:{justify:"center"}},[r("span",{attrs:{id:"summary-text"}},[0==i||1==i||2==i?r("v-icon",{attrs:{color:0==i?"#CCAC00":1==i?"#C0C0C0":"#CC8E34"}},[e._v("mdi-crown")]):e._e(),r("span",{domProps:{innerHTML:e._s(e.$t("DialogSummary.summaryMsgMultiPoints",{playerName:t.playerName,points:t.finalPoints})+(e.showDistance?e.$t("DialogSummary.summaryMsgMultiDistance",{distance:t.finalScore/1e3}):""))}})],1)])})),r("v-row",{staticClass:"mt-8",attrs:{justify:"center"}},[r("v-btn",{staticClass:"mt-8",attrs:{id:"play-again-button",dark:"",color:"#43B581"},on:{click:function(t){return e.$emit("finishGame")}}},[e._v(" "+e._s(e.$t("DialogSummary.viewDetails"))+" ")]),e.multiplayer?e._e():r("v-btn",{staticClass:"mt-8",attrs:{id:"exit-button",dark:"",color:"#f44336"},on:{click:function(t){return e.$emit("playAgain")}}},[e._v(" "+e._s(e.$t("Maps.playAgain"))+" ")])],1)],2)],1)],1)}),C=[],M=(r(34553),r(38862),{props:["dialogSummary","summaryTexts","playerName","score","points","multiplayer","game","mode","mapDetails","nbRound"],computed:{showDistance:function(){return this.mode===m.wz.CLASSIC}},watch:{dialogSummary:function(e){1==e&&this.updateRecord()}},methods:{updateRecord:function(){var e=this,t=localStorage.getItem("history");t=null==t?[]:JSON.parse(t),t.push((0,s.Z)((0,s.Z)({},this.game),{},{score:this.score,points:this.points,rank:this.multiplayer?this.summaryTexts.findIndex((function(t){return t.playerName===e.playerName}))+1:void 0,nbRound:this.nbRound,mapDetails:this.mapDetails})),localStorage.setItem("history",JSON.stringify(t))},finishGame:function(){this.$emit("finishGame")}}}),_=M,L=r(84865),N=r(74266),R=r(50116),V=r(1079),T=r(20563),E=r(50503),$=(0,g.Z)(_,P,C,!1,null,"200a3bd4",null),A=$.exports;v()($,{VBtn:L.Z,VCard:N.Z,VCardText:R.ZB,VDialog:V.Z,VIcon:T.Z,VRow:E.Z});var Z=function(){var e=this,t=e.$createElement,r=e._self._c||t;return e.properties&&"object"===typeof e.properties&&(e.properties.title||e.properties.description)?r("div",{staticClass:"details-map_container"},[r("h2",[e._v(" "+e._s(e.properties.title)+" ")]),r("p",[e._v(" "+e._s(e.properties.description)+" ")]),e.properties.link&&e.validURL(e.properties.link)?r("a",{staticClass:"details-map_link",attrs:{href:e.properties.link,target:"_blank"}},[r("v-icon",{attrs:{color:"darkGreen"}},[e._v("mdi-alert-circle")]),e._v(" "+e._s(e.$t("DetailsMap.moreInfo")))],1):e._e()]):e._e()},G=[],F={name:"DetailsMap",props:["properties"],methods:{validURL:function(e){return(0,d.b3)(e)}}},D=F,B=(0,g.Z)(D,Z,G,!1,null,"4d0af0f4",null),O=B.exports;v()(B,{VIcon:T.Z});var I=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{attrs:{id:"map"}},[r("GmapMap",{ref:"mapRef",attrs:{id:"mapClassic",center:{lat:37.86926,lng:-122.254811},zoom:1,"map-type-id":"roadmap",options:{fullscreenControl:!1,mapTypeControl:!1,streetViewControl:!1,draggableCursor:"crosshair",clickableIcons:!1,styles:e.$vuetify.theme.dark?e.$vuetify.theme.themes.dark.gmap:e.$vuetify.theme.themes.light.gmap}}})],1)},z=[],U={props:["bbox"],watch:{bbox:function(){this.centerOnBbox()}},methods:{centerOnBbox:function(){this.map&&(this.bbox?this.map.fitBounds({east:this.bbox[2],north:this.bbox[3],south:this.bbox[1],west:this.bbox[0]}):(this.map.setZoom(0),this.map.setCenter({lat:0,lng:0})))},drawPolyline:function(){},removePolylines:function(){}}},J=U,j={name:"Map",mixins:[J],data:function(){return{map:null,marker:[],markers:[],polylines:[],strokeColors:m.G8}},mounted:function(){var e=this;return(0,o.Z)((0,a.Z)().mark((function t(){return(0,a.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$gmapApiPromiseLazy();case 2:e.$refs.mapRef.$mapPromise.then((function(t){e.map=t,e.centerOnBbox()}));case 3:case"end":return t.stop()}}),t)})))()},methods:{putMarker:function(e,t,r){var i={};t&&(i={icon:{url:window.location.origin+"/img/icons/favicon-16x16.png",anchor:new google.maps.Point(8,8)}}),r&&(i={label:r});var n=new google.maps.Marker((0,s.Z)((0,s.Z)({},i),{},{position:e,map:this.map}));this.markers.push(n)},removeMarkers:function(){for(var e=0;e<this.markers.length;e++)this.markers[e].setMap(null);this.markers=[]},setInfoWindow:function(e,t,r){var i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],n="";null!==e&&(n+="<b>"+e+"</b> : <br/>"),n+=t<1e3?"<b>"+this.$t("Maps.infoWindow.Distance")+": </b>"+new Intl.NumberFormat(this.$i18n.locale,{style:"unit",unit:"meter"}).format(t):"<b>"+this.$t("Maps.infoWindow.Distance")+": </b>"+new Intl.NumberFormat(this.$i18n.locale,{style:"unit",unit:"kilometer"}).format(t/1e3),n+="<br/><b>"+this.$t("Maps.infoWindow.Points")+": </b>"+r;var a=new google.maps.InfoWindow({content:n});a.open(this.map,this.markers[e||i?this.markers.length-1:0])},drawPolyline:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2?arguments[2]:void 0,i={path:"M 0,-1 0,1",strokeOpacity:1,scale:2},n=new google.maps.Polyline({path:[e,r],strokeOpacity:0,strokeColor:this.strokeColors[t%this.strokeColors.length],icons:[{icon:i,offset:"0",repeat:"10px"}]});n.setMap(this.map),this.polylines.push(n)},removePolylines:function(){for(var e=0;e<this.polylines.length;e++)this.polylines[e].setMap(null)},startNextRound:function(){var e=this;this.$refs.mapRef.$mapPromise.then((function(){e.map.addListener("click",(function(t){e.removeMarkers(),e.putMarker(t.latLng),e.$emit("setSeletedPos",t.latLng)})),e.centerOnBbox()}))},removeListener:function(){google.maps.event.clearListeners(this.map,"click")},fitBounds:function(){for(var e=new google.maps.LatLngBounds,t=0;t<this.markers.length;t++)this.markers[t].getVisible()&&e.extend(this.markers[t].getPosition());this.map.fitBounds(e)}}},q=j,H=(0,g.Z)(q,I,z,!1,null,"4395e0c1",null),K=H.exports,W=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"map-areas",attrs:{id:"map"}},[r("div",{staticClass:"map-content"},[e.polygonSelect||e.areaName?r("div",{staticClass:"map-label",attrs:{title:e.areaName}},[e.showFlag?r("FlagIcon",{attrs:{size:"big",rounded:"","iso-name":e.areaRandom||e.areaNameSelect}}):e._e(),r("span",{staticClass:"map-label__country-name",class:{beige:!e.areaRandom,green:!!e.areaRandom,"white--text":!!e.areaRandom,large:!e.showFlag}},[e._v(" "+e._s(e.areaName)+" ")])],1):e._e(),r("GmapMap",{ref:"mapRef",attrs:{id:"mapAreas",center:{lat:37.86926,lng:-122.254811},zoom:1,"map-type-id":"roadmap",options:{fullscreenControl:!1,mapTypeControl:!1,streetViewControl:!1,draggableCursor:"crosshair",clickableIcons:!1,styles:e.$vuetify.theme.dark?e.$vuetify.theme.themes.dark.gmap:e.$vuetify.theme.themes.light.gmap}}})],1),e.infoWindowDatas.length>0?r("div",{staticClass:"result-panel"},e._l(e.infoWindowDatas,(function(t){return r("div",{key:t.playerName,staticClass:"result-panel__item",class:{flag:e.showFlag}},[e.showFlag?r("FlagIcon",{attrs:{"iso-name":t.area}}):e._e(),r("b",[e._v(e._s(t.playerName))]),e.showFlag?e._e():r("span",[e._v(e._s(t.area))])],1)})),0):e._e()])},Y=[],X=(r(43304),r(7061)),Q={mixins:[J],components:{FlagIcon:X.Z},props:{area:{type:String},areasGeoJsonUrl:String,pathKey:{type:String,default:"iso_a2"},showFlag:Boolean},data:function(){return{map:null,polygonSelect:null,areas:{},markers:[],allowSelect:!0,areaRandom:null,randomPos:null,infoWindowDatas:[]}},computed:(0,s.Z)((0,s.Z)({},(0,h.Se)(["areasJson"])),{},{areaName:function(){return this.showFlag&&(this.areaRandom||this.polygonSelect)?this.$countryNameLocale(this.areaRandom||this.areaNameSelect):this.areaRandom||this.areaNameSelect},areaNameSelect:function(){return this.polygonSelect?this.polygonSelect.getFeatureById("feature").getProperty(this.pathKey):void 0}}),mounted:function(){var e=this;return(0,o.Z)((0,a.Z)().mark((function t(){return(0,a.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.loadAreas(e.areasGeoJsonUrl);case 2:return t.next=4,e.$gmapApiPromiseLazy();case 4:e.$refs.mapRef.$mapPromise.then((function(t){e.map=t,e.areasJson.features.forEach((function(t){if(Array.isArray(t.geometry.coordinates)){var r=new google.maps.Data({style:{strokeOpacity:0,fillOpacity:0,strokeWeight:2}});t.id="feature",r.addGeoJson(t),r.setMap(e.map),r.addListener("click",(function(){e.allowSelect&&(e.polygonSelect&&e.polygonSelect.setStyle({strokeOpacity:0,fillOpacity:0}),Object.is(r,e.polygonSelect)?(e.polygonSelect=null,e.$emit("setSeletedPos",null)):(r.setStyle({strokeOpacity:.8,fillOpacity:.3,strokeColor:"#1E3A8A",fillColor:"#1D4ED8"}),e.polygonSelect=r,e.$emit("setSeletedPos",r.getFeatureById("feature").getProperty(e.pathKey))))})),e.areas[t.properties[e.pathKey]]=r}})),e.centerOnBbox()}));case 5:case"end":return t.stop()}}),t)})))()},methods:(0,s.Z)((0,s.Z)({},(0,h.nv)(["loadAreas"])),{},{putMarker:function(e,t,r){var i=t?r||this.area:e;t&&(this.areaRandom=this.area,this.randomPos=new google.maps.Marker({position:e,map:this.map})),this.areas[i]&&(this.areas[i].setStyle({fillOpacity:.3,strokeOpacity:.8,fillColor:t?"#52DA42":"#FF4081",strokeColor:t?"#16A910":"#FF4081"}),this.markers.push(i))},removeMarkers:function(){var e=this;this.markers.forEach((function(t){e.areas[t].setStyle({strokeOpacity:0,fillOpacity:0})})),this.polygonSelect&&this.polygonSelect.setStyle({strokeOpacity:0,fillOpacity:0}),this.randomPos&&(this.randomPos.setMap(null),this.randomPos=null),this.markers=[],this.infoWindowDatas=[]},setInfoWindow:function(e,t,r,i,n){e&&this.infoWindowDatas.push({playerName:e,area:n})},startNextRound:function(){this.polygonSelect&&this.polygonSelect.setStyle({strokeOpacity:0,fillOpacity:0}),this.polygonSelect=null,this.areaRandom=null,this.allowSelect=!0,this.centerOnBbox()},removeListener:function(){this.allowSelect=!1},fitBounds:function(){this.bbox?this.centerOnBbox():this.map.setZoom(2)}})},ee=Q,te=(0,g.Z)(ee,W,Y,!1,null,"30884500",null),re=te.exports;function ie(e,t,r,i){switch(i){case m.se.TIME:return Math.round(ne(e,t)*Math.exp(-r/6e6));default:return ne(e,t)}}function ne(e,t){if(e<50)return 5e3;var r=Math.round(5e3*Math.exp(-e/1e3/t));return r>5e3?5e3:r<0?0:r}var ae={components:{DialogSummary:A,DetailsMap:O,Map:K,MapAreas:re},props:["randomLatLng","randomFeatureProperties","roomName","playerNumber","playerName","isReady","round","score","points","timeLimitation","difficulty","bbox","mode","area","timeAttack","nbRound","countdown","scoreMode","areasGeoJsonUrl","pathKey","mapDetails"],data:function(){return{summaryTexts:[],room:null,selectedPos:null,distance:null,point:null,isGuessButtonClicked:!1,isMakeGuessButtonClicked:!1,isSelected:!1,isNextStreetViewReady:!1,isNextButtonVisible:!1,isSummaryButtonVisible:!1,dialogSummary:!1,activeMap:!1,size:2,isNotepadVisible:!1,pinActive:"true"===localStorage.getItem("pinActive"),printMapFull:!1,countdownStarted:!1,game:{multiplayer:!!this.roomName,date:new Date,rounds:[]},startTime:null}},computed:{isNextButtonEnabled:function(){return 1==this.playerNumber||!this.room||!!this.isNextStreetViewReady}},watch:{pinActive:function(){localStorage.setItem("pinActive",this.pinActive)}},mounted:function(){var e=this;return(0,o.Z)((0,a.Z)().mark((function t(){var r;return(0,a.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$gmapApiPromiseLazy();case 2:e.game.timeLimitation=e.timeLimitation,e.game.difficulty=e.difficulty,e.game.mode=e.mode,e.game.timeAttack=e.timeAttack,e.game.playerName=e.playerName,r=0,e.roomName&&(e.room=l.Z.database().ref(e.roomName),e.room.on("value",(function(t){if(t.hasChild("active")){if(r=t.child("size").val(),1===r?e.room.onDisconnect().remove():e.room.onDisconnect().update({size:r-1}),e.timeAttack&&0===e.countdown&&t.child("guess").numChildren()>=1&&t.child("guess").forEach((function(t){return t.child("area").val()===e.area}))||t.child("guess").numChildren()===r){e.game.timeLimitation=e.timeLimitation,e.isNextStreetViewReady=!1,e.$emit("showResult");var i=0,n={};t.child("guess").forEach((function(r){var a;if(e.mode===m.wz.CLASSIC){var o=r.child("latitude").val(),l=r.child("longitude").val();a=new google.maps.LatLng({lat:o,lng:l})}else a=r.child("area").val();var u=t.child("playerName").child(r.key).val(),c=t.child("round"+e.round+"/"+r.key).exportVal(),d=c.points,h=c.distance;n[u]=(0,s.Z)((0,s.Z)({},c),{},{guess:a}),e.$refs.map.drawPolyline(a,i,e.randomLatLng),e.$refs.map.putMarker(a,!1,u&&u.length>0?u[0].toUpperCase():""),e.$refs.map.setInfoWindow(u,h,d,!1,a),i++})),e.$refs.map.fitBounds(),e.game.rounds.push({position:(0,s.Z)((0,s.Z)({},e.randomLatLng.toJSON()),{},{area:e.area}),players:n}),e.$refs.map.putMarker(e.randomLatLng,!0),e.printMapFull=!0,e.room.child("guess").remove(),e.round>=e.nbRound?(t.child("finalPoints").forEach((function(r){var i=t.child("playerName").child(r.key).val(),n=t.child("finalScore").child(r.key).val(),a=r.val();e.summaryTexts.push({playerName:i,finalScore:n,finalPoints:a})})),e.summaryTexts.sort((function(e,t){return parseInt(t.finalPoints)-parseInt(e.finalPoints)})),e.isSummaryButtonVisible=!0):e.isNextButtonVisible=!0}t.child("streetView").numChildren()==e.round+1&&(e.isNextStreetViewReady=!0),!e.countdownStarted&&!e.printMapFull&&e.countdown>0&&t.child("guess").numChildren()>=1&&(e.$parent.initTimer(e.countdown,!0),e.countdownStarted=!0)}})));case 9:case"end":return t.stop()}}),t)})))()},methods:{setSeletedPos:function(e){this.selectedPos=e},showMap:function(){this.isMakeGuessButtonClicked=!0},hideMap:function(){this.isMakeGuessButtonClicked=!1},showNotepad:function(){var e=this;this.isNotepadVisible=!this.isNotepadVisible,this.isNotepadVisible&&setTimeout((function(){e.$refs.refNotepad.focus()}))},selectLocation:function(){this.calculateDistance(),this.room?this.room.child("guess/player"+this.playerNumber).set((0,d.nV)(this.selectedPos,this.mode)):(this.$refs.map.putMarker(this.randomLatLng,!0),this.$refs.map.drawPolyline(this.selectedPos,1,this.randomLatLng),this.$refs.map.setInfoWindow(null,this.distance,this.point,!1,this.setSeletedPos),this.printMapFull=!0,this.$refs.map.fitBounds(),this.round>=this.nbRound?this.isSummaryButtonVisible=!0:this.isNextButtonVisible=!0,this.$emit("showResult")),this.$refs.map.removeListener(),this.isGuessButtonClicked=!0,this.isSelected=!0,this.isNextStreetViewReady=!1},selectRandomLocation:function(e){null===this.selectedPos&&(this.selectedPos=e,this.$refs.map.removeMarkers(),this.$refs.map.putMarker(this.selectedPos)),this.selectLocation()},resetLocation:function(){this.$emit("resetLocation")},calculateDistance:function(){var e=new Date-this.startTime;[m.wz.COUNTRY,m.wz.CUSTOM_AREA].includes(this.mode)?(this.point=+(this.area===this.selectedPos),this.distance=null):(this.distance=Math.floor(google.maps.geometry.spherical.computeDistanceBetween(this.randomLatLng,this.selectedPos)),this.point=ie(this.distance,this.difficulty,e,this.scoreMode)),this.room?this.room.child("round"+this.round+"/player"+this.playerNumber).set((0,s.Z)((0,s.Z)({},(0,d.nV)(this.selectedPos,this.mode)),{},{distance:this.distance,points:this.point,timePassed:e})):this.game.rounds.push({guess:this.selectedPos,area:this.area,position:this.randomLatLng,distance:this.distance,points:this.point,timePassed:e}),this.$emit("calculateDistance",this.distance,this.point)},startNextRound:function(){this.$refs.map.startNextRound(),this.startTime=new Date},goToNextRound:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];e&&(this.dialogSummary=!1,this.isSummaryButtonVisible=!1),this.selectedPos=null,this.isGuessButtonClicked=!1,this.isSelected=!1,this.isNextButtonVisible=!1,this.countdownStarted=!1,this.isNotepadVisible=!1,this.$viewport.width<450&&this.hideMap(),this.printMapFull=!1,this.$refs.map.removeMarkers(),this.$refs.map.removePolylines(),this.$refs.map.centerOnBbox(),this.$emit("goToNextRound",e)},finishGame:function(){this.dialogSummary=!1,this.room&&this.room.child("isGameDone/player"+this.playerNumber).set(!0),this.$emit("finishGame")}}},oe=ae,se=(0,g.Z)(oe,x,k,!1,null,"7eafb31a",null),le=se.exports;v()(se,{VBtn:L.Z,VIcon:T.Z});var ue=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-dialog",{attrs:{value:e.dialogMessage,"max-width":"600",persistent:"",fullscreen:e.$viewport.width<450}},[r("v-card",{attrs:{color:"#061422"}},[r("v-card-title",[r("span",{staticClass:"dialog-message__title",attrs:{id:"card-title"}},[e._v(e._s(e.dialogTitle))])]),r("v-card-text",[r("v-container",[r("span",[e._v(e._s(e.dialogText))])])],1)],1)],1)},ce=[],de={props:["dialogMessage","dialogTitle","dialogText"]},me=de,he=r(87986),pe=(0,g.Z)(me,ue,ce,!1,null,"d9759994",null),fe=pe.exports;v()(pe,{VCard:N.Z,VCardText:R.ZB,VCardTitle:R.EB,VContainer:he.Z,VDialog:V.Z});var ge=r(99780),ye=r(17448),ve=(r(39714),r(74916),r(77601),r(69826),r(21703),r(87592)),we=r(82037),be=r(1449),Se=r(53043),xe=r.n(Se),ke=function(){function e(t,r,i,n){(0,ge.Z)(this,e),this.settingsPanorama=t,this.settingsGame=r,this.placeGeoJson=i,this.roundsPredefined=n,this.service=new google.maps.StreetViewService,this.alreadyVisited=[]}return(0,ye.Z)(e,[{key:"getStreetView",value:function(){var e=(0,o.Z)((0,a.Z)().mark((function e(t){var r,i,n,s,l,u,c=this,d=arguments;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(r=d.length>1&&void 0!==d[1]?d[1]:0,this.roundsPredefined)i=50,l=this.roundsPredefined[t-1],n=new google.maps.LatLng(l[0],l[1]);else{do{u=this.getRandomLatLng()}while(this.alreadyVisited.includes(u.position.toString()));this.alreadyVisited.push(u.position.toString()),i=u.radius,n=u.position,s=u.properties}return e.abrupt("return",new Promise((function(e){c.service.getPanorama({location:n,preference:"nearest",radius:i,source:c.settingsPanorama.allPanorama?"default":"outdoor"},function(){var i=(0,o.Z)((0,a.Z)().mark((function i(n,o){return(0,a.Z)().wrap((function(i){while(1)switch(i.prev=i.next){case 0:if(o===google.maps.StreetViewStatus.OK&&n&&n.location&&c._checkStreetView(n)){i.next=8;break}return i.t0=e,i.next=4,c.getStreetView(t);case 4:i.t1=i.sent,(0,i.t0)(i.t1),i.next=13;break;case 8:return i.t2=e,i.next=11,c._getResponseStreetViewService(t,n,r,s);case 11:i.t3=i.sent,(0,i.t2)(i.t3);case 13:case"end":return i.stop()}}),i)})));return function(e,t){return i.apply(this,arguments)}}())})));case 3:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"_getResponseStreetViewService",value:function(){var e=(0,o.Z)((0,a.Z)().mark((function e(t,r,i,n){var o,s,l;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(s=!1,null!=this.placeGeoJson&&(o=(0,d.Rw)(be.xm([r.location.latLng.lng(),r.location.latLng.lat()]),this.placeGeoJson)),!(!1===o&&i<3)){e.next=6;break}return e.abrupt("return",this.getStreetView(t,i+1));case 6:return!1===o&&(s=!0),e.prev=7,e.next=10,this._getAreaCode(r);case 10:l=e.sent,e.next=16;break;case 13:return e.prev=13,e.t0=e["catch"](7),e.abrupt("return",this.getStreetView(t));case 16:return e.abrupt("return",{panorama:r,roundInfo:n||null,area:l,warning:s});case 17:case"end":return e.stop()}}),e,this,[[7,13]])})));function t(t,r,i,n){return e.apply(this,arguments)}return t}()},{key:"getRandomLatLng",value:function(){if(null!=this.placeGeoJson){var e,t,r=null;if("FeatureCollection"===this.placeGeoJson.type){var i=Math.floor(Math.random()*this.placeGeoJson.features.length),n=this.placeGeoJson.features[i];r=n.properties,"Point"===n.geometry.type?(e=n.geometry.coordinates,t=50):(t=100*(0,d.CX)((0,ve.Z)(n)),e=xe()(n))}else t=100*(0,d.CX)((0,ve.Z)(this.placeGeoJson)),e=xe()(this.placeGeoJson);return{radius:t,position:new google.maps.LatLng(e[1],e[0]),properties:r}}var a=170*Math.random()-85,o=360*Math.random()-180;return{radius:1e5,position:new google.maps.LatLng(a,o),properties:null}}},{key:"_checkStreetView",value:function(e){return!(this.settingsPanorama.optimiseStreetView&&(!/^\xA9 (?:\d+ )?Google$/.test(e.copyright)||!e.imageDate||e.links.length<2||Array.isArray(e.g)&&0!==e.g.length))}},{key:"_getAreaCode",value:function(){var e=(0,o.Z)((0,a.Z)().mark((function e(t){var r,i;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(![m.wz.COUNTRY,m.wz.CUSTOM_AREA].includes(this.settingsGame.mode)){e.next=12;break}if(!(this.settingsGame.mode===m.wz.COUNTRY||this.settingsGame.areaParams&&this.settingsGame.areaParams.data.type===m.Ho.NOMINATIM)){e.next=5;break}return e.abrupt("return",(0,d.Xp)(t.location.latLng,this.settingsGame.areaParams&&this.settingsGame.areaParams.data));case 5:if(r=this.settingsGame.areasJson.features.find((function(e){return(0,we.Z)([t.location.latLng.lng(),t.location.latLng.lat()],e)})),r){e.next=10;break}throw new Error("Area not found");case 10:return i=this.settingsGame.areaParams?this.settingsGame.areaParams.data.pathKey:"iso_a2",e.abrupt("return",r.properties[i]);case 12:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()}]),e}(),Pe=ke,Ce={data:function(){return{canExit:!1}},methods:{beforeUnload:function(e){e.returnValue=this.$t("StreetView.confirmExit")}},created:function(){window.addEventListener("beforeunload",this.beforeUnload)},beforeRouteLeave:function(e,t,r){if(this.canExit)r();else{var i=window.confirm(this.$t("StreetView.confirmExit"));i?r():r(!1)}},beforeDestroy:function(){window.removeEventListener("beforeunload",this.beforeUnload)}},Me={components:{HeaderGame:S,Maps:le,DialogMessage:fe},mixins:[Ce],props:{roomName:{default:null,type:String},allPanorama:{default:!1,type:Boolean},optimiseStreetView:{default:!0,type:Boolean},playerNumber:{default:null,type:Number},playerName:{default:null,type:String},placeGeoJson:{default:null,type:Object},multiplayer:{default:!1,type:Boolean},time:{default:0,type:Number},difficulty:{default:2e3,type:Number},bboxObj:{default:null,type:Array},roundsPredefined:{default:null,type:Array},modeSelected:{default:m.wz.CLASSIC,type:String},panControl:{default:!0,type:Boolean},zoomControl:{default:!0,type:Boolean},moveControl:{default:!0,type:Boolean},timeAttackSelected:{default:!1,type:Boolean},countdown:{default:0,type:Number},scoreMode:{default:m.se.NORMAL,type:String},areaParams:{type:Object},mapDetails:{type:Object,required:!1,default:void 0},nbRoundSelected:{type:Number,required:!1,default:5}},data:function(){return{area:null,randomLatLng:null,randomFeatureProperties:null,score:0,scoreHeader:0,points:0,pointsHeader:0,round:1,timeLimitation:this.time,mode:this.modeSelected,timeAttack:this.timeAttackSelected,nbRound:this.timeAttackSelected?10:this.nbRoundSelected,remainingTime:0,endTime:null,hasTimerStarted:!1,hasLocationSelected:!1,overlay:!1,room:null,isReady:!1,dialogMessage:this.multiplayer,dialogTitle:this.$t("StreetView.waitForOtherPlayers"),dialogText:"",isVisibleDialog:!1,panorama:null,difficultyData:this.difficulty,bbox:this.bboxObj,isVisibleCountdownAlert:!1,timeCountdown:0,streetViewService:null}},computed:(0,s.Z)((0,s.Z)({},(0,h.Se)(["areasJson"])),{},{countdownPercentage:function(){return 100*this.remainingTime/this.timeCountdown}}),mounted:function(){var e=this;return(0,o.Z)((0,a.Z)().mark((function t(){return(0,a.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!(e.areaParams&&e.areaParams.data.urlArea||e.mode===m.wz.COUNTRY)){t.next=3;break}return t.next=3,e.loadAreas(e.areaParams&&e.areaParams.data.urlArea);case 3:return t.next=5,e.$gmapApiPromiseLazy();case 5:if(e.panorama=new google.maps.StreetViewPanorama(e.$refs.streetView),e.streetViewService||(e.streetViewService=new Pe({allPanorama:e.allPanorama,optimiseStreetView:e.optimiseStreetView},{mode:e.mode,areaParams:e.areaParams,areasJson:e.areasJson},e.placeGeoJson,e.roundsPredefined)),e.multiplayer){t.next=14;break}return t.next=10,e.loadStreetView();case 10:e.$refs.mapContainer.startNextRound(),0!=e.timeLimitation&&(e.hasTimerStarted||(e.initTimer(e.timeLimitation),e.hasTimerStarted=!0)),t.next=21;break;case 14:if(e.roomName||e.exitGame(),e.room=l.Z.database().ref(e.roomName),1!==e.playerNumber){t.next=19;break}return t.next=19,e.loadStreetView();case 19:e.room.child("active").set(!0),e.room.on("value",(function(t){if(t.hasChild("active")){if(!t.child("round"+e.round).hasChild("player"+e.playerNumber)&&(e.room.child("round"+e.round).child("player"+e.playerNumber).set(0),1!=e.playerNumber)){var r=t.child("streetView/round"+e.round+"/latitude").val(),i=t.child("streetView/round"+e.round+"/longitude").val();e.area=t.child("streetView/round"+e.round+"/area").val(),e.isVisibleDialog=t.child("streetView/round"+e.round+"/warning").val(),e.randomFeatureProperties=t.child("streetView/round"+e.round+"/roundInfo").val(),e.randomLatLng=new google.maps.LatLng(r,i),e.resetLocation()}t.child("round"+e.round).numChildren()!==t.child("size").val()||e.isReady||(e.dialogMessage=!1,e.dialogText="",e.isReady=!0,e.$refs.mapContainer.startNextRound(),e.timeLimitation=t.child("timeLimitation").val(),0!=e.timeLimitation&&(e.hasTimerStarted||(e.initTimer(e.timeLimitation),e.hasTimerStarted=!0))),t.child("isGameDone").numChildren()==t.child("size").val()&&(e.room.child("active").remove(),e.room.off(),e.room.remove())}else e.exitGame()}));case 21:e.$refs.header.startTimer();case 22:case"end":return t.stop()}}),t)})))()},beforeDestroy:function(){document.querySelector(".widget-scene")&&(document.querySelector(".widget-scene").removeEventListener("keydown",this.onUserEventPanoramaKey),document.querySelector(".widget-scene").removeEventListener("mousedown",this.onUserEventPanoramaMouse)),window.removeEventListener("beforeunload",this.beforeUnload),this.room&&(this.room.child("active").remove(),this.room.off())},methods:(0,s.Z)((0,s.Z)({},(0,h.nv)(["loadAreas"])),{},{loadStreetView:function(){var e=this;return(0,o.Z)((0,a.Z)().mark((function t(){var r,i,n,o,l;return(0,a.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.streetViewService.getStreetView(e.round);case 2:r=t.sent,i=r.panorama,n=r.roundInfo,o=r.warning,l=r.area,e.randomLatLng=i.location.latLng,e.randomFeatureProperties=n,e.area=l,e.setPosition(i),e.multiplayer&&e.room.child("streetView/round"+e.round).set((0,s.Z)((0,s.Z)({latitude:e.randomLatLng.lat(),longitude:e.randomLatLng.lng(),roundInfo:n},l&&{area:l}),{},{warning:o}));case 12:case"end":return t.stop()}}),t)})))()},resetLocation:function(){var e=new google.maps.StreetViewService;e.getPanorama({location:this.randomLatLng,preference:"nearest",radius:50,source:this.allPanorama?"default":"outdoor"},this.setPosition)},setPosition:function(e){var t=this;this.panorama.setOptions({addressControl:!1,fullscreenControl:!1,motionTracking:!1,motionTrackingControl:!1,showRoadLabels:!1,panControl:this.panControl,zoomControl:this.zoomControl,scrollwheel:this.zoomControl,disableDoubleClickZoom:!this.zoomControl,linksControl:this.moveControl,clickToGo:this.moveControl}),document.querySelector('#street-view a[href^="https://maps"]')&&document.querySelector('#street-view a[href^="https://maps"]').remove(),setTimeout((function(){document.querySelector(".widget-scene")&&(document.querySelector(".widget-scene").addEventListener("keydown",t.onUserEventPanoramaKey),document.querySelector(".widget-scene").addEventListener("mousedown",t.onUserEventPanoramaMouse),document.querySelector(".widget-scene").addEventListener("touchstart",t.onUserEventPanoramaMouse),document.querySelector(".widget-scene").addEventListener("pointerdown",t.onUserEventPanoramaMouse))}),50),e&&e.location&&this.panorama.setPano(e.location.pano),this.panorama.setPov({heading:270,pitch:0}),this.panorama.setZoom(0)},initTimer:function(e,t){var r=new Date;r.setSeconds(r.getSeconds()+e),t&&(this.timeCountdown=e,this.isVisibleCountdownAlert=!0),this.hasTimerStarted?this.endTime=this.endTime>r?r:this.endTime:(this.endTime=r,this.startTimer())},startTimer:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.round;t===this.round&&(this.remainingTime=Math.max(0,Math.round((this.endTime-Date.now())/1e3)),this.remainingTime>0?setTimeout((function(){e.startTimer(t)}),1e3):(this.timerInProgress=!1,this.hasLocationSelected||([m.wz.COUNTRY,m.wz.CUSTOM_AREA].includes(this.mode)?this.$refs.mapContainer.selectRandomLocation((0,d.j8)(this.areasJson,this.areaParams?this.areaParams.data.pathKey:"iso_a2")):this.$refs.mapContainer.selectRandomLocation(this.streetViewService.getRandomLatLng().position))))},updateScore:function(e,t){this.hasLocationSelected=!0,this.multiplayer||(this.remainingTime=0),this.score+=e,this.points+=t,this.multiplayer&&(this.room.child("finalScore/player"+this.playerNumber).set(this.score),this.room.child("finalPoints/player"+this.playerNumber).set(this.points),this.dialogTitle=this.$t("StreetView.waitForOtherPlayers"),this.dialogMessage=!0)},showResult:function(){this.scoreHeader=this.score,this.pointsHeader=this.points,this.remainingTime=0,this.dialogMessage=!1,this.isVisibleCountdownAlert=!1,this.overlay=!0,this.$refs.header.stopTimer()},goToNextRound:function(){var e=arguments,t=this;return(0,o.Z)((0,a.Z)().mark((function r(){var i;return(0,a.Z)().wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(i=e.length>0&&void 0!==e[0]&&e[0],i&&(t.round=0,t.scoreHeader=0,t.pointsHeader=0,t.score=0,t.points=0),t.randomLatLng=null,t.area=null,t.overlay=!1,t.hasTimerStarted=!1,t.hasLocationSelected=!1,t.isVisibleDialog=!1,t.randomFeatureProperties=null,t.multiplayer&&(t.dialogMessage=!0,t.isReady=!1),t.round+=1,1!=t.playerNumber&&t.multiplayer){r.next=17;break}return r.next=14,t.loadStreetView();case 14:t.multiplayer||0==t.timeLimitation||t.initTimer(t.timeLimitation),r.next=18;break;case 17:t.room.child("trigger/player"+t.playerNumber).set(t.round);case 18:t.$refs.mapContainer.startNextRound();case 19:case"end":return r.stop()}}),r)})))()},exitGame:function(){this.dialogTitle=this.$t("StreetView.redirectToHomePage"),this.dialogText=this.$t("StreetView.exitGame"),this.dialogMessage=!0,this.canExit=!0,this.room?(this.room.off(),this.room.remove(),this.$router.push("/history")):this.$router.push("/")},finishGame:function(){this.canExit=!0,this.multiplayer?(this.dialogTitle=this.$t("StreetView.waitForOtherPlayersToFinish"),this.dialogText="",this.dialogMessage=!0):this.$router.push("/history")},onUserEventPanoramaKey:function(e){(!this.moveControl&&[38,40,87,83,90].includes(e.keyCode)||!this.zoomControl&&[107,109,187,189].includes(e.keyCode)||!this.panControl&&[37,39,65,68,100,102].includes(e.keyCode))&&e.stopPropagation()},onUserEventPanoramaMouse:function(e){this.panControl||e.stopPropagation()}})},_e=Me,Le=r(28468),Ne=r(14867),Re=r(47024),Ve=r(52113),Te=(0,g.Z)(_e,i,n,!1,null,"d9d9e128",null),Ee=Te.exports;v()(Te,{VAlert:Le.Z,VBtn:L.Z,VIcon:T.Z,VOverlay:Ne.Z,VProgressLinear:Re.Z,VTooltip:Ve.Z})}}]);
//# sourceMappingURL=431-legacy.be239493.js.map